> Important in GATE.


# **Chapter 9 – Virtual Memory (Sections 9.1–9.7)**

---

## **9.1 Background**

* **Virtual Memory (VM)** allows execution of processes **not entirely in main memory**.
* Idea: Give an **illusion of a large, continuous memory** to each process.
* Benefits:

  1. Run programs larger than physical memory.
  2. More programs in memory → better CPU utilization.
  3. Separates **logical address space** from **physical address space**.
* Implemented using **demand paging** or **segmentation with paging**.

---

## **9.2 Demand Paging**

* **Lazy loading**: Only bring required pages into memory when needed.
* **Page Fault**:

  * Occurs when the required page is not in memory.
  * Steps:

    1. Check if reference is valid.
    2. If not in memory, fetch from disk.
    3. Restart the instruction.
* **Valid-Invalid Bit** in page table:

  * **Valid** → page is in memory.
  * **Invalid** → page not in memory.

**GATE Tip**: Page faults are **not errors** — they’re a mechanism.

---

## **9.3 Copy-on-Write (COW)**

* Allows parent and child processes to share same memory pages initially.
* Pages are **copied only when modified**.
* Improves fork() performance.

---

## **9.4 Page Replacement**

When memory is full and a new page must be brought in:

1. Identify victim page.
2. If modified (dirty bit = 1) → write back to disk.
3. Replace it with required page.

### **Algorithms**:

1. **FIFO** – Replace oldest page.

   * Simple but may suffer **Belady’s anomaly**.
2. **Optimal (OPT)** – Replace page not used for longest future time.

   * Not implementable, used for benchmarking.
3. **LRU (Least Recently Used)** – Replace page unused for longest past time.

   * Requires time stamps or stack.

**GATE Tip**: Practice **page replacement numerical problems**.

---

## **9.5 Allocation of Frames**

* **Frames** = physical memory units for paging.
* **Allocation policies**:

  * **Fixed allocation**: Each process gets fixed frames.
  * **Variable allocation**: Number of frames may change.
* **Minimum frames** needed depend on instruction set & architecture.

---

## **9.6 Thrashing**

* **Thrashing** = process spends more time **paging** than executing.
* Cause: Degree of multiprogramming too high → not enough frames per process.
* **Working Set Model**:

  * Keep set of pages actively used by process in memory.
* **Page Fault Frequency (PFF)** control:

  * Monitor and adjust frames to keep PFF within limits.

---

## **9.7 Memory-Mapped Files**

* File contents mapped directly into virtual memory space.
* Allows file I/O to be treated as simple memory accesses.
* Useful for:

  * Faster file reading/writing.
  * Sharing memory between processes.

---

### **Exam Takeaways**

* **Conceptual**:

  * Difference between demand paging & prepaging.
  * COW purpose.
  * Thrashing prevention methods.
* **Numericals**:

  * Page fault calculation for FIFO, LRU, OPT.
  * Working set & frame allocation problems.
* **Trick**:

  * Belady’s anomaly occurs **only in FIFO**, not in LRU or OPT.


