
# ‚öõÔ∏è Recoil vs Zustand with Next.js ‚Äì Modern State Management Explained


## üß≠ Introduction

As Next.js applications scale, managing shared and persistent state across multiple pages becomes crucial. While Redux Toolkit and Context API are popular, two **modern and lightweight alternatives**‚Äî**Recoil** and **Zustand**‚Äîhave emerged as developer favorites.

This post compares and demonstrates how to use **Recoil** and **Zustand** with **Next.js**, helping you choose the right state management tool for your app's needs.

---

## üß† What Are Recoil and Zustand?

| Feature      | **Recoil**                                  | **Zustand**                                 |
|--------------|----------------------------------------------|---------------------------------------------|
| Author       | Developed by Meta (Facebook)                | Created by the Poimandres team              |
| Philosophy   | Atom-based, React-driven graph state         | Store-driven with simple getter/setter logic|
| Learning     | Similar to React Context                    | Minimal syntax, easier for beginners        |
| Re-renders   | Fine-grained, scoped reactivity              | Minimal and efficient updates               |
| Persistence  | Needs add-ons or manual implementation       | Built-in middleware support                 |
| SSR Support  | ‚ö†Ô∏è Needs care in SSR scenarios               | ‚úÖ SSR-friendly by default                   |

---

## üì¶ 1. Installing Recoil and Zustand

### üîß For Recoil:

```bash
npm install recoil
```

### üîß For Zustand:

```bash
npm install zustand
```

---

## ‚öôÔ∏è 2. Using Recoil in Next.js

### ‚úÖ Step 1: Wrap App with `<RecoilRoot>`

#### `app/layout.js` (App Router)

```jsx
'use client';
import { RecoilRoot } from 'recoil';

export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body>
        <RecoilRoot>{children}</RecoilRoot>
      </body>
    </html>
  );
}
```

---

### ‚úÖ Step 2: Create and Use Atoms

#### `atoms/themeAtom.js`

```js
import { atom } from 'recoil';

export const themeAtom = atom({
  key: 'themeAtom',
  default: 'light',
});
```

---

#### Usage in component:

```jsx
'use client';
import { useRecoilState } from 'recoil';
import { themeAtom } from '@/atoms/themeAtom';

export default function ThemeToggle() {
  const [theme, setTheme] = useRecoilState(themeAtom);

  return (
    <button onClick={() => setTheme(theme === 'light' ? 'dark' : 'light')}>
      Current theme: {theme}
    </button>
  );
}
```

‚úÖ Great for component-level state with easy hooks  
‚ö†Ô∏è Requires care in SSR apps (wrap with fallback defaults)

---

## ‚öôÔ∏è 3. Using Zustand in Next.js

### ‚úÖ Step 1: Create a Store

#### `store/themeStore.js`

```js
import { create } from 'zustand';

const useThemeStore = create((set) => ({
  theme: 'light',
  toggleTheme: () =>
    set((state) => ({ theme: state.theme === 'light' ? 'dark' : 'light' })),
}));

export default useThemeStore;
```

---

### ‚úÖ Step 2: Use Store in Component

```jsx
'use client';
import useThemeStore from '@/store/themeStore';

export default function ThemeToggle() {
  const { theme, toggleTheme } = useThemeStore();

  return (
    <button onClick={toggleTheme}>Current theme: {theme}</button>
  );
}
```

‚úÖ Zustand works natively with SSR and CSR  
‚úÖ No Provider needed ‚Äî simpler than Recoil or Redux  
‚úÖ Middleware available for persist, devtools, etc.

---

## üîç Recoil vs Zustand ‚Äì Use Case Summary

| Use Case                        | Recommended Tool         | Reason                                |
|----------------------------------|---------------------------|----------------------------------------|
| Fine-grained state updates       | Recoil                    | Scoped atom-based reactivity           |
| Simple shared global state       | Zustand                   | Intuitive and minimal                  |
| SSR support                      | Zustand                   | Works with server components easily    |
| Async derived state              | Recoil                    | Selectors with caching and deps        |
| Persistence (e.g. localStorage)  | Zustand                   | Built-in middleware available          |
| Complex logic or async effects   | Zustand + middleware      | `subscribe`, `persist`, `devtools`    |

---

## üß† Final Thoughts

Both **Recoil** and **Zustand** are excellent modern state management tools for **Next.js**:

- ‚úÖ Choose **Zustand** if you want something **simple, fast, and SSR-ready**
- ‚úÖ Choose **Recoil** if your app benefits from **graph-like reactivity**, similar to React‚Äôs internal state model

> For most apps in 2025, **Zustand is the more scalable and production-friendly choice**, especially with server components and client-store isolation.

---

## üìé Resources

- [Recoil Documentation](https://recoiljs.org/)
- [Zustand Documentation](https://docs.pmnd.rs/zustand)
- [Next.js App Router Docs](https://nextjs.org/docs/app/building-your-application)
