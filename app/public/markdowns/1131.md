Here are **common interview questions and answers on writing SQL queries**, starting from **basic** and moving to **complex** â€” perfect for product-based, service-based, and Enterprise-level interviews:

---

## âœ… Basic SQL Query Questions

---

### ðŸ“Œ **Q1. How do you select all columns from a table?**

**Answer:**

```sql
SELECT * FROM employees;
```

---

### ðŸ“Œ **Q2. How do you filter rows using `WHERE`?**

**Answer:**

```sql
SELECT name, salary FROM employees
WHERE salary > 50000;
```

---

### ðŸ“Œ **Q3. How do you sort results using `ORDER BY`?**

**Answer:**

```sql
SELECT name, salary FROM employees
ORDER BY salary DESC;
```

---

### ðŸ“Œ **Q4. How do you get unique values using `DISTINCT`?**

**Answer:**

```sql
SELECT DISTINCT department FROM employees;
```

---

### ðŸ“Œ **Q5. How do you count rows in a table?**

**Answer:**

```sql
SELECT COUNT(*) FROM employees;
```

---

### ðŸ“Œ **Q6. What is the difference between `WHERE` and `HAVING`?**

**Answer:**

- `WHERE` filters **before** grouping  
- `HAVING` filters **after** grouping

```sql
-- Example
SELECT department, COUNT(*) FROM employees
GROUP BY department
HAVING COUNT(*) > 5;
```

---

## ðŸš€ Intermediate to Complex SQL Query Questions

---

### ðŸ“Œ **Q7. Write a query to fetch the second highest salary.**

**Answer 1: Using `LIMIT` and `OFFSET` (MySQL/PostgreSQL):**

```sql
SELECT DISTINCT salary FROM employees
ORDER BY salary DESC
LIMIT 1 OFFSET 1;
```

**Answer 2: Using subquery (DB-agnostic):**

```sql
SELECT MAX(salary) FROM employees
WHERE salary < (SELECT MAX(salary) FROM employees);
```

---

### ðŸ“Œ **Q8. Write a query to get the department-wise average salary.**

**Answer:**

```sql
SELECT department, AVG(salary) AS avg_salary
FROM employees
GROUP BY department;
```

---

### ðŸ“Œ **Q9. How do you find duplicate records based on a column?**

**Answer:**

```sql
SELECT email, COUNT(*) 
FROM users
GROUP BY email
HAVING COUNT(*) > 1;
```

---

### ðŸ“Œ **Q10. How do you join two tables (INNER JOIN)?**

**Answer:**

```sql
SELECT e.name, d.name AS department_name
FROM employees e
INNER JOIN departments d
ON e.department_id = d.id;
```

---

### ðŸ“Œ **Q11. How do you perform a LEFT JOIN and why?**

**Answer:**

To get all employees, even if they donâ€™t belong to any department:

```sql
SELECT e.name, d.name AS department_name
FROM employees e
LEFT JOIN departments d
ON e.department_id = d.id;
```

---

### ðŸ“Œ **Q12. Write a query to find employees who earn more than the average salary.**

**Answer:**

```sql
SELECT name, salary
FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees);
```

---

### ðŸ“Œ **Q13. How do you update rows conditionally?**

**Answer:**

```sql
UPDATE employees
SET salary = salary * 1.1
WHERE performance_rating = 'Excellent';
```

---

### ðŸ“Œ **Q14. How do you get the top N records per group (e.g., top 2 salaries per department)?**

**Answer (PostgreSQL/MySQL 8+ using `ROW_NUMBER`)**:

```sql
SELECT * FROM (
  SELECT *,
    ROW_NUMBER() OVER (PARTITION BY department_id ORDER BY salary DESC) AS rn
  FROM employees
) ranked
WHERE rn <= 2;
```

---

### ðŸ“Œ **Q15. Write a query to get all managers who donâ€™t have subordinates.**

**Answer:**

```sql
SELECT e.name FROM employees e
LEFT JOIN employees sub
ON e.id = sub.manager_id
WHERE sub.id IS NULL AND e.is_manager = true;
```

---

### ðŸ“Œ **Q16. How do you find the department with the maximum number of employees?**

**Answer:**

```sql
SELECT department_id
FROM employees
GROUP BY department_id
ORDER BY COUNT(*) DESC
LIMIT 1;
```

---

### ðŸ“Œ **Q17. How to pivot rows to columns in SQL (basic)?**

**Answer (using CASE WHEN):**

```sql
SELECT 
  department_id,
  SUM(CASE WHEN gender = 'Male' THEN 1 ELSE 0 END) AS male_count,
  SUM(CASE WHEN gender = 'Female' THEN 1 ELSE 0 END) AS female_count
FROM employees
GROUP BY department_id;
```

---

### ðŸ“Œ **Q18. How do you delete duplicate rows keeping only one?**

**Answer (PostgreSQL with CTE):**

```sql
WITH cte AS (
  SELECT *, 
         ROW_NUMBER() OVER (PARTITION BY email ORDER BY id) AS rn
  FROM users
)
DELETE FROM users
WHERE id IN (
  SELECT id FROM cte WHERE rn > 1
);
```

---

